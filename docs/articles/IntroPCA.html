<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to PCA • ChemoSpec</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to PCA">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChemoSpec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">5.1.48</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ChemoSpec.pdf">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IntroPCA.html">An Introduction to PCA</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>An Introduction to PCA</h1>
                        <h4 class="author">Bryan A. Hanson</h4>
            <address class="author_afil">
      a<br><div class="hidden name"><code>IntroPCA.Rmd</code></div>

    </address>
</div>

    
    
<p>The audience for this document is chemists, spectroscopists and people in allied fields who are using spectroscopy to analyze their data.</p>
<p>We will use two data sets here: one is a set of elemental analyses of glass artifacts; we use this relatively small, non-spectroscopic data set to help understand PCA fundamentals. The second data set is a collection of IR spectra of plant oils.</p>
<div id="conceptual-introduction-to-pca" class="section level1">
<h1 class="hasAnchor">
<a href="#conceptual-introduction-to-pca" class="anchor"></a>Conceptual Introduction to PCA</h1>
<p>PCA is conducted on data sets composed of:</p>
<ul>
<li>Samples, typically in rows.</li>
<li>Variables which were measured for each sample.</li>
</ul>
<p>The purpose of PCA is <em>data reduction</em>. This term refers to the goal of:</p>
<ul>
<li>Reducing the size of the data set by identifying variables that are not informative. Such variables are also described as “noisy”, in that they don’t add anything to the study. Such variables arise naturally in many situations. Example: a survey about food preferences may include questions about political party. The answers about political party may not be informative.</li>
<li>Collapsing correlating variables. Several of the variables measured in a study may actually be measures of the same underlying reality. This is not to say they are noisy, but rather they may be redundant. Example: a survey asks participants if they eat kale, and separately, if they eat quinoa. Individuals may answer yes to both questions or no to both questions. The answers may reflect the individuals preference for a healthy diet. Either question alone may be sufficient. PCA will collapse these correlating variables into one variable.</li>
</ul>
<p>What does one get from PCA?</p>
<ul>
<li>An indication of how many principal components (PC) are needed to describe the data, generally presented as a <em>scree plot</em>.</li>
<li>Scores, generally presented as one or more <em>score plots</em>.</li>
<li>Loadings, generally presented as one or more <em>loading plots</em>.</li>
</ul>
<p>These plots will be explained further in the next section. Other things to know about PCA before going further:</p>
<ul>
<li>PCA is <em>principal</em> not <em>principle</em> components analysis!</li>
<li>PCA is the “mother” of a number of other related techniques, so if you plan further study it is critical to understand PCA to the greatest degree possible.</li>
<li>That said, it takes most people a long time to fully grasp what PCA does, especially from the mathematical perspective. Don’t expect to get all the nuances on the first pass!</li>
<li>
<em>And the problem</em> The results of PCA, scores and loadings, exist in a so-called abstract space. This space is only distantly and indirectly related to the space in which the original samples reside. Therefore, the results of PCA are frequently difficult to interepret in concrete terms. See previous point.</li>
</ul>
</div>
<div id="pca-results-illustrated-no-code-no-math" class="section level1">
<h1 class="hasAnchor">
<a href="#pca-results-illustrated-no-code-no-math" class="anchor"></a>PCA Results Illustrated, No Code, No Math</h1>
<p>This section is designed to illustrate the concepts of PCA, and how to interpret the plots that arise from PCA.</p>
<p>We’ll use a data set which reports chemical analyses on archaeological glass artifacts that was designed to determine the origin of the artifacts. Table  gives a little bit of the data set.</p>

<p>There are 180 glass artifacts (the samples) in this data set (hence 180 rows), and the elements analyzed were , , , , , , , , , , , , and  .</p>
<p>We’ll perform PCA on the glass data set, show the three plots and then discuss them in turn. Figure  shows the scree plot, Figure  shows the score plot and Figure  shows the first loadings.</p>
<div class="figure">
<img src="IntroPCA_files/figure-html/glassScree-1.png" alt="Scree plot from PCA on the glass data set.\label{fig:glassScree}" width="336"><p class="caption">
Scree plot from PCA on the glass data set.
</p>
</div>
<p>Figure , the scree plot, shows the amount of variance in the data set explained by each principal component (PCs are along the x axis, from 1 to 10). For now, think of variance as the variation or variability in the data set, or better, think of it as the hidden signal in the data. To interpret this plot, we look for the point at which the height of the bars suddenly levels off. In this case, the first three PCs drop steadily downward, but from PC four and onward there is little additional variation (signal) that can be explained. We would say that three PCs are enough to explain this data set. In other words, the original 13 variables have been reduced to three, which is a great simplification.</p>
<div class="figure">
<img src="IntroPCA_files/figure-html/glassScores-1.png" alt="Score plot from PCA on the glass data set.\label{fig:glassScores}" width="336"><p class="caption">
Score plot from PCA on the glass data set.
</p>
</div>
<p>In Figure  one sees the scores for PC 1 plotted against the scores for PC 2. There are 180 points in this plot because there is one point per sample (put another way, every sample has a score value for PC 1 and for PC 2). This plot is interpreted by looking for clustering of samples, as well as for samples that are outliers, off by themselves. Depending upon your eye, there are 3 to 5 clusters here. Later we’ll discuss how we can explore this further.</p>
<p>We could also plot PC 1 against PC 3, or PC 2 against PC 3. These might show different clustering and separation of samples, but are not shown here. There wouldn’t be much point in plotting PC 4 or higher, as PCs 4 and higher are mostly noise, not signal, as established by the scree plot (Figure ).</p>
<div class="figure">
<img src="IntroPCA_files/figure-html/glassLoadings-1.png" alt="Loadings plot for the first PC from PCA on the glass data set.\label{fig:glassLoadings}" width="336"><p class="caption">
Loadings plot for the first PC from PCA on the glass data set.
</p>
</div>
<p>The loadings plot, Figure , shows how much each measured variable contributes to the component and hence the separation of samples (in this case the loadings for PC 1). We see that three elements have large loadings, and the other elements contribute little to the separation. We would say separation along PC 1 is driven largely and <em>collectively</em> by the results for ,  and . The first PC should be interpreted as a composite of these variables – these variables have been collapsed into one new variable, PC 1.</p>
<div id="refinements-1" class="section level2">
<h2 class="hasAnchor">
<a href="#refinements-1" class="anchor"></a>Refinements 1</h2>
<p>Rather than relying on a scree plot to determine the number of PCs that are important, we can present the same information in a table, see Table . A general rule of thumb says to keep enough PCs to account for 95% of the variation (signal). The table tells us the same as the plot: keep three PCs.</p>

</div>
<div id="refinements-2" class="section level2">
<h2 class="hasAnchor">
<a href="#refinements-2" class="anchor"></a>Refinements 2</h2>
<p>The mathematics of PCA do not take into account anything about the samples other than the measured variables. However, the researcher may well know something about the samples, for instance, they may fall into groups based on their origin. If this is the case, the points on the score plot can be colored according to the group. This may aid significantly in the interpretation. Lucky for us, we can do this for the glass data set. The samples fell into four groups. We’ll re-do the score plot with colors corresponding to the known groups (Figure ).</p>
<div class="figure">
<img src="IntroPCA_files/figure-html/groups-1.png" alt="Score plot from PCA on the glass data set, with groups color-coded.\label{fig:glassScores2}" width="336"><p class="caption">
Score plot from PCA on the glass data set, with groups color-coded.
</p>
</div>
<p>With this figure, we can see that the large group in the lower left corner (in black), which to the eye might have been two groups, is composed of related samples.</p>
</div>
</div>
<div id="a-spectroscopic-data-set" class="section level1">
<h1 class="hasAnchor">
<a href="#a-spectroscopic-data-set" class="anchor"></a>A Spectroscopic Data Set</h1>
<p>The archaeological data set has the advantage of only having a few variables, the percentages of each element in the glass artifacts. If we move to a spectroscopic data set, the number of variables goes up dramatically. A UV-Vis data set typically would have a few hundred to a thousand wavelength variables, an IR data set perhaps a few thousand data points, and a 1D NMR data set would typically have 16K or more data points. As far as PCA is concerned, in these cases the scree plot and score plot do not change in appearance or interpretation.</p>
<p>However, the loading plot changes appearance dramatically. This is because with hundreds to thousands of variables, one would not create a loading plot based on a bar chart (Figure  is a bar chart). Instead, the loading plot with many variables looks like a spectrum! While the appearance is different, the interpretation is the same as for when there are only a few variables.</p>
<p>Let’s illustrate with an IR data set. We’ll use a data set included with the  package. This is a set of IR spectra of plant oils which are mixtures of triglycerides (triacylglyerols, which are esters), and free fatty acids. Figure  shows a typical spectrum from the data set.</p>
<div class="figure">
<img src="IntroPCA_files/figure-html/IRSpectrum-1.png" alt="Spectrum 1 from the IR data set.\label{fig:IRSpecrum}" width="336"><p class="caption">
Spectrum 1 from the IR data set.
</p>
</div>
<p>Next, we’ll carry out PCA as before, and show the scree plot (Figure ) and the score plot (Figure ). Note that these appear like the corresponding plots for the glass data set, and are interpreted in the same manner. However, the loadings plot, Figure , looks a lot like a spectrum, because it has 1868 data points, and is plotted as a connected scatter plot and not as a bar chart (which would be difficult to read).</p>
<div class="figure">
<img src="IntroPCA_files/figure-html/IRScree-1.png" alt="Scree plot from PCA on the IR data set.\label{fig:IRScree}" width="336"><p class="caption">
Scree plot from PCA on the IR data set.
</p>
</div>
<div class="figure">
<img src="IntroPCA_files/figure-html/IRScores-1.png" alt="Score plot from PCA on the IR data set.\label{fig:IRScores}" width="336"><p class="caption">
Score plot from PCA on the IR data set.
</p>
</div>
<div class="figure">
<img src="IntroPCA_files/figure-html/IRLoadings-1.png" alt="Loadings plot for the first PC from PCA on the IR data set.\label{fig:IRLoadings}" width="336"><p class="caption">
Loadings plot for the first PC from PCA on the IR data set.
</p>
</div>
<p>Let’s look at the carbonyl region of the loadings plot in detail. Figure  shows the original spectrum in red, for reference, and the loadings in black. One can see that the ester carbonyl contributes positively to the first loading, while the carboxylic acid carbonyl contributes negatively.</p>
<p>Finally, to make the point that the loading plot for many variables is essentially the same as the loading plot for just a few variables, Figure  shows the carbonyl region as a kind of bar plot. If one connects the tips of the bars together, one gets the previous plot.</p>
<div class="figure">
<img src="IntroPCA_files/figure-html/IRLoadings2-1.png" alt="Loadings plot for the first PC from PCA on the IR data set, carbonyl region. Reference spectrum shown in red.\label{fig:IRLoadings2}" width="336"><p class="caption">
Loadings plot for the first PC from PCA on the IR data set, carbonyl region. Reference spectrum shown in red.
</p>
</div>
<div class="figure">
<img src="IntroPCA_files/figure-html/IRLoadings3-1.png" alt="Loadings plot for the first PC from PCA on the IR data set, carbonyl region, shown as a bar plot.\label{fig:IRLoadings3}" width="336"><p class="caption">
Loadings plot for the first PC from PCA on the IR data set, carbonyl region, shown as a bar plot.
</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#conceptual-introduction-to-pca">Conceptual Introduction to PCA</a></li>
      <li>
<a href="#pca-results-illustrated-no-code-no-math">PCA Results Illustrated, No Code, No Math</a><ul class="nav nav-pills nav-stacked">
<li><a href="#refinements-1">Refinements 1</a></li>
      <li><a href="#refinements-2">Refinements 2</a></li>
      </ul>
</li>
      <li><a href="#a-spectroscopic-data-set">A Spectroscopic Data Set</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Bryan A. Hanson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
